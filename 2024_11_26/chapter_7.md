## 컴파일러

##### 파이썬 코드를 파싱하면 파이썬 코드의 연산자, 함수, 클래스, 이름 공간을 포함하는 AST가 생성된다.
##### 컴파일러의 역할은 이러한 AST를 CPU 명령으로 바꾸는 것이다.

![alt text](image.png)

##### 컴파일러 : AST를 순회하며 논리적 실행 순서를 나타내는 제어 흐름 그래프(control flow graph, CFG)를 생성한다.

##### 어셈블러 : CFG의 노드들을 실행 가능한 명령을 순차적으로 나열한 바이트 코드 형태로 변환한다.

##### 컴파일 과정
##### [파서] - AST -> [컴파일러] - CFG -> [어셈블러] - 바이트코드 -> 실행

##### 이번 장에서는 AST 모듈을 코드 객체로 컴파일 하는 과정에 대해서 알아 본다.

##### Python/compile.c : 컴파일러 구현
##### Include/compile.h : 컴파일러 API와 타입 정의

##### 처음 접하는 용어
##### 컴파일러 상태 : 심벌 테이블을 담는 컨테이너 타입
##### 심벌 테이블 : 변수 이름을 포함하고 추가로 하위 심벌 테이블을 포함 할 수 있다.
##### 컴파일러 타입에는 컴파일러 유닛도 포함된다.
##### 컴파일러 유닛 : 각각 이름, 변수 이름, 상수, 셀 변수들을 포함한다.
##### 컴파일러 유닛은 기본 프레임 블록을 포함한다.
##### 기본 프레임 블록은 바이트코드 명령을 포함한다. 

![alt text](image-1.png)

##### 컴파일러 상태 컨테이너와 컨테이너의 구성 요소를 그림으로 표현한 것이다.

### 7.1 컴파일러 인스턴스 생성

##### 컴파일러를 실행하기에 앞서 전역 컴파일러 상태가 생성된다.
##### 컴파일러 상태 구조체인 compiler 타입은 컴파일러 플래그나 스택, PyArena등 컴파일러를 위한 다양한 프로퍼티를 포함한다.
##### 컴파일러 상태는 심벌 테이블 등의 다른 구조체도 포함한다. 

### 7.2 퓨처 플래그와 컴파일러 플래그

##### 퓨처 플래그와 컴파일러 플래그는 컴파일러 기능을 설정한다.
##### 이플래그 들은 다음 위치에서 설정 할 수 있다.

##### 1. 환경 변수와 명령줄 플래그를 담는 구성 상태
##### 2. 모듈 소스 코드의 __future__문

#### 7.2.1 퓨처 플래그

##### 퓨처 플래그는 특정 모듈에서 문법이나 언어 기능을 활성화하기 위해 사용된다.

##### from __future__ import annotations

##### 이 퓨처 문 아래부터 결정되지 않은 타입 힌트를 사용할 수 있다.

#### 7.2.2 파이썬 3.9의 퓨처 플래그 목록

#### 7.2.3 컴파일러 플래그

##### 컴파일러 플래그는 실행 환경에 의존적이기 때문에 코드나 컴파일러의 실행 방식을 변경 할 수 있다.

***

### 7.3 심벌 테이블

##### 코드를 컴파일하기 전에 PySymtable_BuildObject() API는 심벌 테이블을 생성 한다.

#### 7.3.1 연관된 소스 파일 목록

##### Python/symtable.c : 심벌 테이블 구현
##### Include/symtable.h : 심벌 테이블 API와 타입정의
##### Lib/symtable.py : 표준 라이브러리의 symtable 모듈

#### 7.3.2 심벌 테이블 구조체

##### 심볼 테이블의 역할
##### 1. 두 클래스 가 동일한 이름의 메서드를 가지고 있을 경우 모듈에서 어떤 메서드를 호출하지 정해 주는것이 symtable의 역할
##### 2. 하위 스코프의 변수를 상위 스코프에서 사용하지 못하게 하는 것
##### 3. 위와 같이 변수 충돌 방지 및 오류를 줄이고 실행 성능을 높입니다.

![alt text](IMG_1845.jpeg)

#### 7.3.3 symtable 모듈

#### 7.3.4 심벌 테이블 구현

***

### 7.4 핵심 컴파일 과정

#### 7.4.1 파이썬에서 컴파일러 사용하기

#### 7.4.2 컴파일러 C API

#### 7.4.3 명령

#### 7.4.4 기본 프레임 블록

#### 7.4.5 명령어와 인자

***

### 7.5 어셈블리

#### 7.5.1 어셈블러 구조체 

#### 7.5.2 어셈블러의 깊이 우선 탐색 알고리즘

#### 7.5.3 어셈블러 C API

#### 7.5.4 깊이 우선 탐색

***

### 7.6 코드 객체 색성

***

### 7.7 인스타비즈로 코드 객체 시각화 하기

***

### 7.8 예제: '거의 같음' 연산자 구현하기